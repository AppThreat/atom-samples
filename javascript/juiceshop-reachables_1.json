[{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398629,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous5","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":52,"tags":""},{"id":398641,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous5","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398658,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous5","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":68,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398749,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398704,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":81,"tags":""},{"id":398735,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":76,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398751,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous6","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":78,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398833,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398788,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":106,"tags":""},{"id":398819,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":86,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398835,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous7","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":88,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398917,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":113,"tags":""},{"id":398903,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":96,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":398919,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":98,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399001,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":398956,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":113,"tags":""},{"id":398987,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":106,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399003,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous9","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":108,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399085,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399040,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":122,"tags":""},{"id":399071,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"servePublicFiles()","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":299679,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/fileServer.ts::program","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"<global>","parentClassName":"routes/fileServer.ts::program","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":418759,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"servePublicFiles","parentMethodSignature":"","parentFileName":"routes/fileServer.ts","parentPackageName":"","parentClassName":"","lineNumber":14,"columnNumber":7,"tags":"exported"},{"id":399087,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous10","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":118,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":399121,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/fileServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":23,"tags":""},{"id":399124,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":21,"columnNumber":2,"tags":""},{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399128,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":30,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399133,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":38,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399138,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":46,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399143,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":54,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399148,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":63,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399153,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":72,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399158,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":82,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399163,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":92,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399168,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":102,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":399173,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":112,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":399234,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('fileServer', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    req = { params: {}, query: {} }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  it('should serve PDF files from folder /ftp', () => {\n    req.params.file = 'test.pdf'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.pdf/))\n  })\n\n  it('should serve Markdown files from folder /ftp', () => {\n    req.params.file = 'test.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]test\\.md/))\n  })\n\n  it('should serve incident-support.kdbx files from folder /ftp', () => {\n    req.params.file = 'incident-support.kdbx'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]incident-support\\.kdbx/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should raise error for disallowed file type', () => {\n    req.params.file = 'nice.try'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('should solve \"directoryListingChallenge\" when requesting acquisitions.md', () => {\n    challenges.directoryListingChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'acquisitions.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]acquisitions\\.md/))\n    expect(challenges.directoryListingChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"easterEggLevelOneChallenge\" when requesting eastere.gg with Poison Null Byte attack', () => {\n    challenges.easterEggLevelOneChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'eastere.gg%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]eastere\\.gg/))\n    expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenDevBackupChallenge\" when requesting package.json.bak with Poison Null Byte attack', () => {\n    challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'package.json.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]package\\.json\\.bak/))\n    expect(challenges.forgottenDevBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"forgottenBackupChallenge\" when requesting coupons_2013.md.bak with Poison Null Byte attack', () => {\n    challenges.forgottenBackupChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'coupons_2013.md.bak%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]coupons_2013\\.md\\.bak/))\n    expect(challenges.forgottenBackupChallenge.solved).to.equal(true)\n  })\n\n  it('should solve \"misplacedSignatureFileChallenge\" when requesting suspicious_errors.yml with Poison Null Byte attack', () => {\n    challenges.misplacedSignatureFileChallenge = { solved: false, save } as unknown as Challenge\n    req.params.file = 'suspicious_errors.yml%00.md'\n\n    servePublicFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\\\]suspicious_errors\\.yml/))\n    expect(challenges.misplacedSignatureFileChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/fileServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/fileServerSpec.ts::program","lineNumber":15,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402391,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":64,"tags":""},{"id":402403,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":27,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402417,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":29,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":402509,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":22,"tags":""},{"id":402512,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":18,"columnNumber":2,"tags":""},{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402391,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":64,"tags":""},{"id":402403,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":27,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402417,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":29,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402391,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":64,"tags":""},{"id":402403,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":27,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402419,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":29,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":402509,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":22,"tags":""},{"id":402512,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":18,"columnNumber":2,"tags":""},{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402391,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":64,"tags":""},{"id":402403,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":27,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402419,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":29,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402437,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":51,"tags":""},{"id":402449,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":35,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402464,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":37,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":402509,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":22,"tags":""},{"id":402512,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":18,"columnNumber":2,"tags":""},{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402437,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":51,"tags":""},{"id":402449,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":35,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402464,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":37,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402437,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":51,"tags":""},{"id":402449,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":35,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402464,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.sendFile)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":37,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402437,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":51,"tags":""},{"id":402449,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":35,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402466,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":37,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402437,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":51,"tags":""},{"id":402449,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":35,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402466,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":37,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":402509,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":22,"tags":""},{"id":402512,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":18,"columnNumber":2,"tags":""},{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402437,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":51,"tags":""},{"id":402449,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"serveKeyFiles()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":35,"columnNumber":4,"tags":""},{"id":301890,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/keyServer.ts::program","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"<global>","parentClassName":"routes/keyServer.ts::program","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":418823,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"serveKeyFiles","parentMethodSignature":"","parentFileName":"routes/keyServer.ts","parentPackageName":"","parentClassName":"","lineNumber":9,"columnNumber":7,"tags":"exported"},{"id":402466,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.sendFile","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":37,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":402509,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":22,"tags":""},{"id":402512,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":18,"columnNumber":2,"tags":""},{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":402509,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/keyServerSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":22,"tags":""},{"id":402512,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":18,"columnNumber":2,"tags":""},{"id":402516,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":24,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":402521,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":402568,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('keyServer', () => {\n  let req: any\n  let res: any\n  let next: any\n\n  beforeEach(() => {\n    req = { params: { } }\n    res = { sendFile: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n  })\n\n  it('should serve requested file from folder /encryptionkeys', () => {\n    req.params.file = 'test.file'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.been.calledWith(sinon.match(/encryptionkeys[/\\\\]test.file/))\n  })\n\n  it('should raise error for slashes in filename', () => {\n    req.params.file = '../../../../nice.try'\n\n    serveKeyFiles()(req, res, next)\n\n    expect(res.sendFile).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/keyServerSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/keyServerSpec.ts::program","lineNumber":13,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":403865,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":9,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403828,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403828,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403828,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403828,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403830,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403830,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":403865,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":9,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403830,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"},{"id":403802,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":14,"tags":""},{"id":403814,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":37,"columnNumber":8,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403830,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":403810,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"req.query.to = url","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":35,"columnNumber":23,"tags":"framework-input"},{"id":403837,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect).to.have.been.calledWith(url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":403810,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"req.query.to = url","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":35,"columnNumber":23,"tags":"framework-input"},{"id":403837,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect).to.have.been.calledWith(url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":39,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":403865,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":9,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403843,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":59,"tags":""},{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":403864,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":403865,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":34,"columnNumber":9,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":52,"tags":""},{"id":403884,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":47,"columnNumber":4,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403899,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":49,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":52,"tags":""},{"id":403884,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":47,"columnNumber":4,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403899,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":49,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":52,"tags":""},{"id":403884,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":47,"columnNumber":4,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403899,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(res.redirect)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":49,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":52,"tags":""},{"id":403884,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":47,"columnNumber":4,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403901,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":49,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":52,"tags":""},{"id":403884,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":47,"columnNumber":4,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403901,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":49,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":403872,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":52,"tags":""},{"id":403884,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"performRedirect()","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":47,"columnNumber":4,"tags":""},{"id":313023,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"routes/redirect.ts::program","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"<global>","parentClassName":"routes/redirect.ts::program","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":419106,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"performRedirect","parentMethodSignature":"","parentFileName":"routes/redirect.ts","parentPackageName":"","parentClassName":"","lineNumber":13,"columnNumber":7,"tags":"exported"},{"id":403901,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":49,"columnNumber":11,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":404184,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/redirectSpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":21,"tags":""},{"id":404187,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":23,"columnNumber":2,"tags":""},{"id":404191,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":32,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":404196,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":44,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":404284,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('redirect', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n\n  beforeEach(() => {\n    req = { query: {} }\n    res = { redirect: sinon.spy(), status: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('should be performed for all allowlisted URLs', () => {\n    for (const url of redirectAllowlist) {\n      it(url, () => {\n        req.query.to = url\n\n        performRedirect()(req, res, next)\n\n        expect(res.redirect).to.have.been.calledWith(url)\n      })\n    }\n  })\n\n  it('should raise error for URL not on allowlist', () => {\n    req.query.to = 'http://kimminich.de'\n\n    performRedirect()(req, res, next)\n\n    expect(res.redirect).to.have.not.been.calledWith(sinon.match.any)\n    expect(next).to.have.been.calledWith(sinon.match.instanceOf(Error))\n  })\n\n  it('redirecting to https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://explorer.dash.org/address/Xr556RzuwX6hg5EGpkybbv5RanJoZN17kW'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('redirecting to https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6 should solve the \"redirectCryptoCurrencyChallenge\"', () => {\n    req.query.to = 'https://etherscan.io/address/0x0f933ab9fcaaa782d0279c300d73750e1311eae6'\n    challenges.redirectCryptoCurrencyChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectCryptoCurrencyChallenge.solved).to.equal(true)\n  })\n\n  it('tricking the allowlist should solve \"redirectChallenge\"', () => {\n    req.query.to = 'http://kimminich.de?to=https://github.com/juice-shop/juice-shop'\n    challenges.redirectChallenge = { solved: false, save } as unknown as Challenge\n\n    performRedirect()(req, res, next)\n\n    expect(challenges.redirectChallenge.solved).to.equal(true)\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/redirectSpec.ts","parentPackageName":"<global>","parentClassName":"test/server/redirectSpec.ts::program","lineNumber":17,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":405894,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":49,"columnNumber":6,"tags":"framework-input"},{"id":405899,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":50,"columnNumber":6,"tags":""},{"id":405915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405894,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":49,"columnNumber":6,"tags":"framework-input"},{"id":405899,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":50,"columnNumber":6,"tags":""},{"id":405915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405894,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":49,"columnNumber":6,"tags":"framework-input"},{"id":405899,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":50,"columnNumber":6,"tags":""},{"id":405915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405894,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":49,"columnNumber":6,"tags":"framework-input"},{"id":405899,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":50,"columnNumber":6,"tags":""},{"id":405915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"},{"id":405925,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":54,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405894,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":49,"columnNumber":6,"tags":"framework-input"},{"id":405899,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":50,"columnNumber":6,"tags":""},{"id":405915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":39,"tags":"framework-output"},{"id":405925,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":54,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"},{"id":405925,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":54,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405889,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":91,"tags":""},{"id":405914,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":52,"columnNumber":6,"tags":"framework-output"},{"id":405925,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":54,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405947,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":58,"columnNumber":6,"tags":"framework-input"},{"id":405952,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":59,"columnNumber":6,"tags":""},{"id":405968,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405947,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":58,"columnNumber":6,"tags":"framework-input"},{"id":405952,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":59,"columnNumber":6,"tags":""},{"id":405968,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405947,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":58,"columnNumber":6,"tags":"framework-input"},{"id":405952,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":59,"columnNumber":6,"tags":""},{"id":405968,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405947,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":58,"columnNumber":6,"tags":"framework-input"},{"id":405952,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":59,"columnNumber":6,"tags":""},{"id":405968,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"},{"id":405978,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":63,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"},{"id":405978,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":63,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":405947,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":58,"columnNumber":6,"tags":"framework-input"},{"id":405952,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":59,"columnNumber":6,"tags":""},{"id":405968,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":39,"tags":"framework-output"},{"id":405978,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":63,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"},{"id":405978,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":63,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405942,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":86,"tags":""},{"id":405967,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":61,"columnNumber":6,"tags":"framework-output"},{"id":405978,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous2","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":63,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406000,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":67,"columnNumber":6,"tags":"framework-input"},{"id":406005,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":68,"columnNumber":6,"tags":""},{"id":406021,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406000,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":67,"columnNumber":6,"tags":"framework-input"},{"id":406005,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":68,"columnNumber":6,"tags":""},{"id":406021,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406000,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":67,"columnNumber":6,"tags":"framework-input"},{"id":406005,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":68,"columnNumber":6,"tags":""},{"id":406021,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406000,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":67,"columnNumber":6,"tags":"framework-input"},{"id":406005,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":68,"columnNumber":6,"tags":""},{"id":406021,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"},{"id":406031,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":72,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"},{"id":406031,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":72,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406000,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":67,"columnNumber":6,"tags":"framework-input"},{"id":406005,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":68,"columnNumber":6,"tags":""},{"id":406021,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":39,"tags":"framework-output"},{"id":406031,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":72,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"},{"id":406031,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":72,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"},{"id":406031,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":72,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":405995,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":93,"tags":""},{"id":406020,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":70,"columnNumber":6,"tags":"framework-output"},{"id":406031,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous3","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":72,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406053,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":76,"columnNumber":6,"tags":"framework-input"},{"id":406058,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":77,"columnNumber":6,"tags":""},{"id":406069,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406053,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":76,"columnNumber":6,"tags":"framework-input"},{"id":406058,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":77,"columnNumber":6,"tags":""},{"id":406069,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406053,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":76,"columnNumber":6,"tags":"framework-input"},{"id":406058,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":77,"columnNumber":6,"tags":""},{"id":406069,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406053,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":76,"columnNumber":6,"tags":"framework-input"},{"id":406058,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":77,"columnNumber":6,"tags":""},{"id":406069,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":39,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406053,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":76,"columnNumber":6,"tags":"framework-input"},{"id":406058,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.headers","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":77,"columnNumber":6,"tags":""},{"id":406069,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":39,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406048,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":90,"tags":""},{"id":406068,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"verify.forgedFeedbackChallenge()(req, res, next)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":79,"columnNumber":6,"tags":"framework-output"},{"id":406079,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"expect(challenges.forgedFeedbackChallenge.solved)","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":81,"columnNumber":6,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"},{"id":406093,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":40,"tags":""},{"id":406097,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":38,"columnNumber":4,"tags":"framework-output"},{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":406101,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":48,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406106,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":57,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406111,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":66,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":406116,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":75,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"},{"id":407745,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"test/server/verifySpec.ts::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":19,"tags":""},{"id":407748,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":28,"columnNumber":2,"tags":""},{"id":407752,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":37,"columnNumber":2,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":407883,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"describe('verify', () => {\n  let req: any\n  let res: any\n  let next: any\n  let save: any\n  let err: any\n\n  beforeEach(() => {\n    req = { body: {}, headers: {} }\n    res = { json: sinon.spy() }\n    next = sinon.spy()\n    save = () => ({\n      then () { }\n    })\n  })\n\n  describe('\"forgedFeedbackChallenge\"', () => {\n    beforeEach(() => {\n      security.authenticatedUsers.put('token12345', {\n        data: {\n          id: 42,\n          email: 'test@juice-sh.op'\n        } as unknown as UserModel\n      })\n      challenges.forgedFeedbackChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is not solved when an authenticated user passes his own ID when writing feedback', () => {\n      req.body.UserId = 42\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is not solved when an authenticated user passes no ID when writing feedback', () => {\n      req.body.UserId = undefined\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(false)\n    })\n\n    it('is solved when an authenticated user passes someone elses ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = { authorization: 'Bearer token12345' }\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n\n    it('is solved when an unauthenticated user passes someones ID when writing feedback', () => {\n      req.body.UserId = 1\n      req.headers = {}\n\n      verify.forgedFeedbackChallenge()(req, res, next)\n\n      expect(challenges.forgedFeedbackChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('accessControlChallenges', () => {\n    it('\"scoreBoardChallenge\" is solved when the 1px.png transpixel is requested', () => {\n      challenges.scoreBoardChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/1px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.scoreBoardChallenge.solved).to.equal(true)\n    })\n\n    it('\"adminSectionChallenge\" is solved when the 19px.png transpixel is requested', () => {\n      challenges.adminSectionChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/19px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.adminSectionChallenge.solved).to.equal(true)\n    })\n\n    it('\"tokenSaleChallenge\" is solved when the 56px.png transpixel is requested', () => {\n      challenges.tokenSaleChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/padding/56px.png'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.tokenSaleChallenge.solved).to.equal(true)\n    })\n\n    it('\"extraLanguageChallenge\" is solved when the Klingon translation file is requested', () => {\n      challenges.extraLanguageChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/i18n/tlh_AA.json'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.extraLanguageChallenge.solved).to.equal(true)\n    })\n\n    it('\"retrieveBlueprintChallenge\" is solved when the blueprint file is requested', () => {\n      challenges.retrieveBlueprintChallenge = { solved: false, save } as unknown as Challenge\n      setRetrieveBlueprintChallengeFile('test.dxf')\n      req.url = 'http://juice-sh.op/public/images/products/test.dxf'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.retrieveBlueprintChallenge.solved).to.equal(true)\n    })\n\n    it('\"missingEncodingChallenge\" is solved when the crazy cat photo is requested', () => {\n      challenges.missingEncodingChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/public/images/uploads/%E1%93%9A%E1%98%8F%E1%97%A2-%23zatschi-%23whoneedsfourlegs-1572600969477.jpg'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.missingEncodingChallenge.solved).to.equal(true)\n    })\n\n    it('\"accessLogDisclosureChallenge\" is solved when any server access log file is requested', () => {\n      challenges.accessLogDisclosureChallenge = { solved: false, save } as unknown as Challenge\n      req.url = 'http://juice-sh.op/support/logs/access.log.2019-01-15'\n\n      verify.accessControlChallenges()(req, res, next)\n\n      expect(challenges.accessLogDisclosureChallenge.solved).to.equal(true)\n    })\n  })\n\n  describe('\"errorHandlingChallenge\"', () => {\n    beforeEach(() => {\n      challenges.errorHandlingChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('is solved when an error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n    })\n\n    describe('is solved when an error occurs on a response with error', () => {\n      const httpStatus = [402, 403, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = new Error()\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(true)\n        })\n      })\n    })\n\n    it('is not solved when no error occurs on a response with OK 200 status code', () => {\n      res.statusCode = 200\n      err = undefined\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n    })\n\n    describe('is not solved when no error occurs on a response with error', () => {\n      const httpStatus = [401, 402, 404, 500]\n      httpStatus.forEach(statusCode => {\n        it(`${statusCode} status code`, () => {\n          res.statusCode = statusCode\n          err = undefined\n\n          verify.errorHandlingChallenge()(err, req, res, next)\n\n          expect(challenges.errorHandlingChallenge.solved).to.equal(false)\n        })\n      })\n    })\n\n    it('should pass occurred error on to next route', () => {\n      res.statusCode = 500\n      err = new Error()\n\n      verify.errorHandlingChallenge()(err, req, res, next)\n\n      expect(next).to.have.been.calledWith(err)\n    })\n  })\n\n  describe('databaseRelatedChallenges', () => {\n    describe('\"changeProductChallenge\"', () => {\n      beforeEach(() => {\n        challenges.changeProductChallenge = { solved: false, save } as unknown as Challenge\n        products.osaft = { reload () { return { then (cb: any) { cb() } } } } as unknown as Product\n      })\n\n      it(`is solved when the link in the O-Saft product goes to ${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}`, () => {\n        products.osaft.description = `O-Saft, yeah! <a href=\"${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(true)\n      })\n\n      it('is not solved when the link in the O-Saft product is changed to an arbitrary URL', () => {\n        products.osaft.description = 'O-Saft, nooo! <a href=\"http://arbitrary.url\" target=\"_blank\">More...</a>'\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n\n      it('is not solved when the link in the O-Saft product remained unchanged', () => {\n        let urlForProductTamperingChallenge = null\n        for (const product of config.get<ProductConfig[]>('products')) {\n          if (product.urlForProductTamperingChallenge !== undefined) {\n            urlForProductTamperingChallenge = product.urlForProductTamperingChallenge\n            break\n          }\n        }\n        products.osaft.description = `Vanilla O-Saft! <a href=\"${urlForProductTamperingChallenge}\" target=\"_blank\">More...</a>`\n\n        verify.databaseRelatedChallenges()(req, res, next)\n\n        expect(challenges.changeProductChallenge.solved).to.equal(false)\n      })\n    })\n  })\n\n  describe('jwtChallenges', () => {\n    beforeEach(() => {\n      challenges.jwtUnsignedChallenge = { solved: false, save } as unknown as Challenge\n      challenges.jwtForgedChallenge = { solved: false, save } as unknown as Challenge\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has email jwtn3d@juice-sh.op in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQGp1aWNlLXNoLm9wIn0sImlhdCI6MTUwODYzOTYxMiwiZXhwIjo5OTk5OTk5OTk5fQ.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is solved when forged unsigned token has string \"jwtn3d@\" in the payload', () => {\n      /*\n      Header: { \"alg\": \"none\", \"typ\": \"JWT\" }\n      Payload: { \"data\": { \"email\": \"jwtn3d@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n       */\n      req.headers = { authorization: 'Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJkYXRhIjp7ImVtYWlsIjoiand0bjNkQCJ9LCJpYXQiOjE1MDg2Mzk2MTIsImV4cCI6OTk5OTk5OTk5OX0.' }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtUnsignedChallenge.solved).to.equal(true)\n    })\n\n    it('\"jwtUnsignedChallenge\" is not solved via regularly signed token even with email jwtn3d@juice-sh.op in the payload', () => {\n      const token = security.authorize({ data: { email: 'jwtn3d@juice-sh.op' } })\n      req.headers = { authorization: `Bearer ${token}` }\n\n      verify.jwtChallenges()(req, res, next)\n\n      expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n    })\n\n    if (utils.isChallengeEnabled(challenges.jwtForgedChallenge)) {\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@juice-sh.op\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAanVpY2Utc2gub3AifSwiaWF0IjoxNTgyMjIxNTc1fQ.ycFwtqh4ht4Pq9K5rhiPPY256F9YCTIecd4FHFuSEAg' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is solved when forged token HMAC-signed with public RSA-key has string \"rsa_lord@\" in the payload', () => {\n        /*\n        Header: { \"alg\": \"HS256\", \"typ\": \"JWT\" }\n        Payload: { \"data\": { \"email\": \"rsa_lord@\" }, \"iat\": 1508639612, \"exp\": 9999999999 }\n         */\n        req.headers = { authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImVtYWlsIjoicnNhX2xvcmRAIn0sImlhdCI6MTU4MjIyMTY3NX0.50f6VAIQk2Uzpf3sgH-1JVrrTuwudonm2DKn2ec7Tg8' }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(true)\n      })\n\n      it('\"jwtForgedChallenge\" is not solved when token regularly signed with private RSA-key has email rsa_lord@juice-sh.op in the payload', () => {\n        const token = security.authorize({ data: { email: 'rsa_lord@juice-sh.op' } })\n        req.headers = { authorization: `Bearer ${token}` }\n\n        verify.jwtChallenges()(req, res, next)\n\n        expect(challenges.jwtForgedChallenge.solved).to.equal(false)\n      })\n    }\n  })\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"test/server/verifySpec.ts","parentPackageName":"<global>","parentClassName":"test/server/verifySpec.ts::program","lineNumber":21,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]}]
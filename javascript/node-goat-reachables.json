[{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":129989,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/allocations.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":66,"tags":""},{"id":129998,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129996,"label":"CALL","name":"next","fullName":"app/routes/allocations.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129995,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":21,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":129991,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":130016,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""}],"purls":[]},{"flows":[{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":129989,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/allocations.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":66,"tags":""},{"id":129998,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129996,"label":"CALL","name":"next","fullName":"app/routes/allocations.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129995,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":21,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":129991,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":130016,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""}],"purls":[]},{"flows":[{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"},{"id":129989,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/allocations.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":66,"tags":""},{"id":129998,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129996,"label":"CALL","name":"next","fullName":"app/routes/allocations.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129995,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":21,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":129991,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":130016,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"},{"id":129989,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/allocations.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":66,"tags":""},{"id":129998,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129996,"label":"CALL","name":"next","fullName":"app/routes/allocations.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":28,"tags":""},{"id":129995,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":24,"columnNumber":21,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":129991,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":130016,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""}],"purls":[]},{"flows":[{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":129991,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":130016,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""},{"id":130001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":19,"tags":"framework-output"},{"id":130000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":12,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":129991,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":130016,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""},{"id":130001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":19,"tags":"framework-output"},{"id":130000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":12,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""}],"purls":[]},{"flows":[{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":130011,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":26,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""},{"id":130001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":19,"tags":"framework-output"},{"id":130000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":12,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""}],"purls":[]},{"flows":[{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":130011,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":26,"columnNumber":16,"tags":""},{"id":129986,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":25,"columnNumber":45,"tags":""},{"id":130001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":19,"tags":"framework-output"},{"id":130000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":12,"tags":""},{"id":130024,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""},{"id":130061,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":""}],"purls":[]},{"flows":[{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130033,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":130059,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130046,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":130044,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":130060,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130105,"label":"IDENTIFIER","name":"AllocationsHandler","fullName":"","signature":"","isExternal":false,"code":"function AllocationsHandler = function AllocationsHandler(db) {\n    \"use strict\";\n\n    const allocationsDAO = new AllocationsDAO(db);\n\n    this.displayAllocations = (req, res, next) => {\n        /*\n        // Fix for A4 Insecure DOR -  take user id from session instead of from URL param\n        const { userId } = req.session;\n        */\n        const {\n            userId\n        } = req.params;\n        const {\n            threshold\n        } = req.query;\n\n        allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        });\n    };\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":6,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":130314,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"},{"id":130286,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/benefits.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":61,"tags":""},{"id":130294,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130292,"label":"CALL","name":"next","fullName":"app/routes/benefits.js::program:next","signature":"","isExternal":true,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":23,"tags":""},{"id":130303,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130334,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130298,"label":"IDENTIFIER","name":"benefitsDAO","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.getAllNonAdminUsers","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":39,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"},{"id":130286,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/benefits.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":61,"tags":""},{"id":130294,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130292,"label":"CALL","name":"next","fullName":"app/routes/benefits.js::program:next","signature":"","isExternal":true,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":23,"tags":""},{"id":130303,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130334,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130298,"label":"IDENTIFIER","name":"benefitsDAO","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.getAllNonAdminUsers","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":39,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130332,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"},{"id":130286,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/benefits.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":61,"tags":""},{"id":130294,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130292,"label":"CALL","name":"next","fullName":"app/routes/benefits.js::program:next","signature":"","isExternal":true,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":23,"tags":""},{"id":130303,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130334,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130298,"label":"IDENTIFIER","name":"benefitsDAO","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.getAllNonAdminUsers","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":39,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130332,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130314,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130314,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130332,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"},{"id":130287,"label":"METHOD_PARAMETER_IN","name":"error","fullName":"","signature":"","isExternal":false,"code":"error","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":62,"tags":""},{"id":130295,"label":"IDENTIFIER","name":"error","fullName":"","signature":"","isExternal":false,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":35,"tags":""},{"id":130292,"label":"CALL","name":"next","fullName":"app/routes/benefits.js::program:next","signature":"","isExternal":true,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":130291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":23,"tags":""},{"id":130303,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""},{"id":130334,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":""}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130332,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130314,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130332,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130312,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":130333,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130385,"label":"IDENTIFIER","name":"BenefitsHandler","fullName":"","signature":"","isExternal":false,"code":"function BenefitsHandler = function BenefitsHandler(db) {\n    \"use strict\";\n\n    const benefitsDAO = new BenefitsDAO(db);\n\n    this.displayBenefits = (req, res, next) => {\n\n        benefitsDAO.getAllNonAdminUsers((error, users) => {\n\n            if (error) return next(error);\n\n            return res.render(\"benefits\", {\n                users,\n                user: {\n                    isAdmin: true\n                },\n                environmentalScripts\n            });\n        });\n    };\n\n    this.updateBenefits = (req, res, next) => {\n        const {\n            userId,\n            benefitStartDate\n        } = req.body;\n\n        benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        });\n    };\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":8,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""},{"id":130578,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130616,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":130659,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":130759,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130756,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":130600,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":130645,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":130757,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":130608,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":130652,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":130758,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_6.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":60,"columnNumber":16,"tags":""},{"id":130554,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_6","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":130616,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":130659,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":130759,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130600,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":130645,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":130757,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130756,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130608,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":130652,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":130758,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130608,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":130652,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":130758,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"},{"id":130560,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":130569,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":130566,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":130565,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130756,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130616,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":130659,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":130759,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"},{"id":130560,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":130569,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":130566,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":130565,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130600,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":130645,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":130757,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"},{"id":130560,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":130569,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":130566,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":130565,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130608,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":130652,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":130758,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""},{"id":130576,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":19,"tags":"framework-output"},{"id":130575,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":12,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130616,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":130659,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":130759,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""},{"id":130576,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":19,"tags":"framework-output"},{"id":130575,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":12,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130756,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""},{"id":130576,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":19,"tags":"framework-output"},{"id":130575,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":12,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130600,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":130645,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":130757,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"},{"id":130561,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":130584,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""},{"id":130556,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":47,"tags":""},{"id":130576,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":19,"tags":"framework-output"},{"id":130575,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":12,"tags":""},{"id":130592,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""},{"id":130760,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":""}],"purls":[]},{"flows":[{"id":130600,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":130645,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":130757,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130608,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":130652,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":130758,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130756,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130616,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":130659,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":130759,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130756,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130608,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":130652,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":130758,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130600,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":130645,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":130757,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130616,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":130659,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":130759,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130808,"label":"IDENTIFIER","name":"ContributionsHandler","fullName":"","signature":"","isExternal":false,"code":"function ContributionsHandler = function ContributionsHandler(db) {\n    \"use strict\";\n\n    const contributionsDAO = new ContributionsDAO(db);\n\n    this.displayContributions = (req, res, next) => {\n        const {\n            userId\n        } = req.session;\n\n        contributionsDAO.getByUserId(userId, (error, contrib) => {\n            if (error) return next(error);\n\n            contrib.userId = userId; //set for nav menu items\n            return res.render(\"contributions\", {\n                ...contrib,\n                environmentalScripts\n            });\n        });\n    };\n\n    this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            });\n        }\n        // Prevent more than 30% contributions\n        if (preTax + afterTax + roth > 30) {\n            return res.render(\"contributions\", {\n                updateError: \"Contribution percentages cannot exceed 30 %\",\n                userId,\n                environmentalScripts\n            });\n        }\n\n        contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        });\n\n    };\n\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":7,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""},{"id":130697,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":130696,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":130762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":""},{"id":130786,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            });\n        }\n        // Prevent more than 30% contributions\n        if (preTax + afterTax + roth > 30) {\n            return res.render(\"contributions\", {\n                updateError: \"Contribution percentages cannot exceed 30 %\",\n                userId,\n                environmentalScripts\n            });\n        }\n\n        contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        });\n\n    }","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":142070,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":131061,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":130987,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":18,"columnNumber":33,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131008,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""},{"id":130697,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":130696,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":130762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":""},{"id":130786,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            });\n        }\n        // Prevent more than 30% contributions\n        if (preTax + afterTax + roth > 30) {\n            return res.render(\"contributions\", {\n                updateError: \"Contribution percentages cannot exceed 30 %\",\n                userId,\n                environmentalScripts\n            });\n        }\n\n        contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        });\n\n    }","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":142070,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":131061,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":130987,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":18,"columnNumber":33,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""},{"id":130697,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":130696,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":130762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":""},{"id":130786,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            });\n        }\n        // Prevent more than 30% contributions\n        if (preTax + afterTax + roth > 30) {\n            return res.render(\"contributions\", {\n                updateError: \"Contribution percentages cannot exceed 30 %\",\n                userId,\n                environmentalScripts\n            });\n        }\n\n        contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        });\n\n    }","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":142070,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":131061,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":130987,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":18,"columnNumber":33,"tags":""}],"purls":[]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"},{"id":132125,"label":"CALL","name":"get","fullName":"needle:get","signature":"","isExternal":true,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":19,"tags":"framework-output, http-client"},{"id":132124,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":12,"tags":""},{"id":132146,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":12,"columnNumber":27,"tags":""},{"id":132166,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.displayResearch = (req, res) => {\n\n        if (req.query.symbol) {\n            const url = req.query.url + req.query.symbol;\n            return needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            });\n        }\n\n        return res.render(\"research\", {\n            environmentalScripts\n        });\n    }","typeFullName":"","parentMethodName":"ResearchHandler","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":12,"columnNumber":27,"tags":"exported"},{"id":142127,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ResearchHandler","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":131091,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"new ResearchHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":21,"columnNumber":28,"tags":"framework-output"},{"id":130996,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_6","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":21,"columnNumber":28,"tags":""}],"purls":["pkg:npm/needle@2.2.4"]},{"flows":[{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""},{"id":130697,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":130696,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":130762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":""},{"id":130786,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            });\n        }\n        // Prevent more than 30% contributions\n        if (preTax + afterTax + roth > 30) {\n            return res.render(\"contributions\", {\n                updateError: \"Contribution percentages cannot exceed 30 %\",\n                userId,\n                environmentalScripts\n            });\n        }\n\n        contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        });\n\n    }","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":142070,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":131061,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":130987,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":18,"columnNumber":33,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131182,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":131192,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":131202,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":131212,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":131222,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":131232,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":131242,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":131252,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":130620,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":130624,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":130712,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":130552,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":50,"columnNumber":47,"tags":""},{"id":130697,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":130696,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":130762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":""},{"id":130786,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            });\n        }\n        // Prevent more than 30% contributions\n        if (preTax + afterTax + roth > 30) {\n            return res.render(\"contributions\", {\n                updateError: \"Contribution percentages cannot exceed 30 %\",\n                userId,\n                environmentalScripts\n            });\n        }\n\n        contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        });\n\n    }","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":142070,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":131061,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":130987,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_3","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":18,"columnNumber":33,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""}],"purls":[]},{"flows":[{"id":131262,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""}],"purls":[]},{"flows":[{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"},{"id":131003,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":131010,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131006,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":131005,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":131017,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""},{"id":131265,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131830,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":131829,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":131909,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":""},{"id":131933,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    }","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":142117,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":131041,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":130981,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_1","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":27,"tags":""},{"id":131184,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":25,"tags":""},{"id":131194,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":30,"tags":""},{"id":131204,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":31,"tags":""},{"id":131214,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":25,"tags":""},{"id":131224,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":26,"tags":""},{"id":131234,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":36,"tags":""},{"id":131244,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":22,"tags":""},{"id":131254,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":23,"tags":""},{"id":131264,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131346,"label":"IDENTIFIER","name":"index","fullName":"","signature":"","isExternal":false,"code":"const index = (app, db) => {\n\n    \"use strict\";\n\n    const sessionHandler = new SessionHandler(db);\n    const profileHandler = new ProfileHandler(db);\n    const benefitsHandler = new BenefitsHandler(db);\n    const contributionsHandler = new ContributionsHandler(db);\n    const allocationsHandler = new AllocationsHandler(db);\n    const memosHandler = new MemosHandler(db);\n    const researchHandler = new ResearchHandler(db);\n\n    // Middleware to check if a user is logged in\n    const isLoggedIn = sessionHandler.isLoggedInMiddleware;\n\n    //Middleware to check if user has admin rights\n    const isAdmin = sessionHandler.isAdminUserMiddleware;\n\n    // The main page of the app\n    app.get(\"/\", sessionHandler.displayWelcomePage);\n\n    // Login form\n    app.get(\"/login\", sessionHandler.displayLoginPage);\n    app.post(\"/login\", sessionHandler.handleLoginRequest);\n\n    // Signup form\n    app.get(\"/signup\", sessionHandler.displaySignupPage);\n    app.post(\"/signup\", sessionHandler.handleSignup);\n\n    // Logout page\n    app.get(\"/logout\", sessionHandler.displayLogoutPage);\n\n    // The main page of the app\n    app.get(\"/dashboard\", isLoggedIn, sessionHandler.displayWelcomePage);\n\n    // Profile page\n    app.get(\"/profile\", isLoggedIn, profileHandler.displayProfile);\n    app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate);\n\n    // Contributions Page\n    app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions);\n    app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate);\n\n    // Benefits Page\n    app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits);\n    app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits);\n    /* Fix for A7 - checks user role to implement  Function Level Access Control\n     app.get(\"/benefits\", isLoggedIn, isAdmin, benefitsHandler.displayBenefits);\n     app.post(\"/benefits\", isLoggedIn, isAdmin, benefitsHandler.updateBenefits);\n     */\n\n    // Allocations Page\n    app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations);\n\n    // Memos Page\n    app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos);\n    app.post(\"/memos\", isLoggedIn, memosHandler.addMemos);\n\n    // Handle redirect for learning resources link\n    app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    });\n\n    // Research Page\n    app.get(\"/research\", isLoggedIn, researchHandler.displayResearch);\n\n    // Mount tutorial router\n    app.use(\"/tutorial\", tutorialRouter);\n\n    // Error handling middleware\n    app.use(ErrorHandler);\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":11,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131422,"label":"IDENTIFIER","name":"memosDAO","fullName":"","signature":"","isExternal":false,"code":"memosDAO.insert(req.body.memo, (err, docs) => {\n            if (err) return next(err);\n            this.displayMemos(req, res, next);\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/memos.js","parentPackageName":"<global>","parentClassName":"app/routes/memos.js::program","lineNumber":13,"columnNumber":8,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131549,"label":"IDENTIFIER","name":"MemosHandler","fullName":"","signature":"","isExternal":false,"code":"function MemosHandler = function MemosHandler(db) {\n    \"use strict\";\n\n    const memosDAO = new MemosDAO(db);\n\n    this.addMemos = (req, res, next) => {\n\n        memosDAO.insert(req.body.memo, (err, docs) => {\n            if (err) return next(err);\n            this.displayMemos(req, res, next);\n        });\n    };\n\n    this.displayMemos = (req, res, next) => {\n\n        const {\n            userId\n        } = req.session;\n\n        memosDAO.getAllMemos((err, docs) => {\n            if (err) return next(err);\n            return res.render(\"memos\", {\n                memosList: docs,\n                userId: userId,\n                environmentalScripts\n            });\n        });\n    };\n\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/memos.js","parentPackageName":"<global>","parentClassName":"app/routes/memos.js::program","lineNumber":6,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""},{"id":131748,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131726,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131828,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":131845,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131860,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131855,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131850,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131875,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131870,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131865,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":131715,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_5","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":41,"tags":""}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131900,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131821,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":131773,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":131883,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":131899,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":131744,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":131754,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":131721,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_7","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":100,"columnNumber":45,"tags":""},{"id":131746,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":131745,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":131762,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131907,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":""},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131771,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":131901,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":131903,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":131904,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":131902,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":131905,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":131898,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":"pkg:npm/url@0.11.0"},{"id":131897,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":131906,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":["pkg:npm/url@0.11.0"]},{"flows":[{"id":131959,"label":"IDENTIFIER","name":"ProfileHandler","fullName":"","signature":"","isExternal":false,"code":"function ProfileHandler = function ProfileHandler(db) {\n    \"use strict\";\n\n    const profile = new ProfileDAO(db);\n\n    this.displayProfile = (req, res, next) => {\n        const {\n            userId\n        } = req.session;\n\n\n\n        profile.getByUserId(parseInt(userId), (err, doc) => {\n            if (err) return next(err);\n            doc.userId = userId;\n\n            // @TODO @FIXME\n            // while the developer intentions were correct in encoding the user supplied input so it\n            // doesn't end up as an XSS attack, the context is incorrect as it is encoding the firstname for HTML\n            // while this same variable is also used in the context of a URL link element\n            doc.website = ESAPI.encoder().encodeForHTML(doc.website);\n            // fix it by replacing the above with another template variable that is used for \n            // the context of a URL in a link header\n            // doc.website = ESAPI.encoder().encodeForURL(doc.website)\n\n            return res.render(\"profile\", {\n                ...doc,\n                environmentalScripts\n            });\n        });\n    };\n\n    this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow saving\n        if (testComplyWithRequirements !== true) {\n            const firstNameSafeString = firstName;\n            return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            });\n        }\n\n        const {\n            userId\n        } = req.session;\n\n        profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        );\n\n    };\n\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":8,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"},{"id":132043,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":132087,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":132093,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":132089,"label":"CALL","name":"end","fullName":"res.end","signature":"","isExternal":true,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":132088,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":132095,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":35,"tags":""},{"id":132131,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":35,"tags":""},{"id":132043,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""}],"purls":["pkg:npm/needle@2.2.4"]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"},{"id":132043,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":132087,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":132093,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"}],"purls":["pkg:npm/needle@2.2.4"]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"}],"purls":["pkg:npm/needle@2.2.4"]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"}],"purls":[]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"},{"id":132043,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":132087,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":132093,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":132135,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":31,"columnNumber":15,"tags":"framework-output"}],"purls":["pkg:npm/needle@2.2.4"]},{"flows":[{"id":132112,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":132130,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output, http-client"},{"id":132043,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":132087,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":132093,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":132137,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"research\", {\n            environmentalScripts\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":31,"columnNumber":15,"tags":"framework-output"}],"purls":["pkg:npm/needle@2.2.4"]},{"flows":[{"id":132192,"label":"IDENTIFIER","name":"ResearchHandler","fullName":"","signature":"","isExternal":false,"code":"function ResearchHandler = function ResearchHandler(db) {\n    \"use strict\";\n\n    const researchDAO = new ResearchDAO(db);\n\n    this.displayResearch = (req, res) => {\n\n        if (req.query.symbol) {\n            const url = req.query.url + req.query.symbol;\n            return needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            });\n        }\n\n        return res.render(\"research\", {\n            environmentalScripts\n        });\n    };\n\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":7,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132964,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":132270,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132629,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"},{"id":132485,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":51,"tags":""},{"id":132577,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":32,"tags":""},{"id":132574,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":27,"tags":""},{"id":132573,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":20,"tags":""},{"id":132600,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":""},{"id":132631,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":""},{"id":132510,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":132522,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":132479,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_4","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":82,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"},{"id":132485,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":51,"tags":""},{"id":132577,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":32,"tags":""},{"id":132574,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":27,"tags":""},{"id":132573,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":20,"tags":""},{"id":132600,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":""},{"id":132631,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":""},{"id":132510,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":132522,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":132479,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_4","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":82,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":132611,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"},{"id":132485,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":51,"tags":""},{"id":132577,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":32,"tags":""},{"id":132574,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":27,"tags":""},{"id":132573,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":100,"columnNumber":20,"tags":""},{"id":132600,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":""},{"id":132631,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":""},{"id":132510,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":132522,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":132479,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_4","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":82,"columnNumber":47,"tags":""}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132629,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132611,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132629,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132611,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132629,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132630,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":132611,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":132609,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":132629,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        })","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132950,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/session.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":80,"tags":""},{"id":132959,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132932,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132950,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/session.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":80,"tags":""},{"id":132959,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132932,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132950,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/session.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":80,"tags":""},{"id":132959,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132932,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132950,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/session.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":80,"tags":""},{"id":132959,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132932,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132950,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/session.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":80,"tags":""},{"id":132959,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132932,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132950,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"app/routes/session.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":80,"tags":""},{"id":132959,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132932,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":132930,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":132929,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":132946,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""},{"id":132975,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":132930,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":132929,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":132946,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""},{"id":132975,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":132930,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":132929,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":132946,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""},{"id":132975,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":132930,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":132929,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":132946,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""},{"id":132975,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":132930,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":132929,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":132946,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""},{"id":132975,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":132930,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":132929,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":132946,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""},{"id":132975,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133018,"label":"IDENTIFIER","name":"userDAO","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":16,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133018,"label":"IDENTIFIER","name":"userDAO","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":16,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132951,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":132960,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":132957,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":132956,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":132977,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""},{"id":133026,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":132982,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":49,"tags":""},{"id":132991,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":37,"tags":""},{"id":132988,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":32,"tags":""},{"id":132987,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":25,"tags":""},{"id":133028,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":""},{"id":133105,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":""}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":132982,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":49,"tags":""},{"id":132991,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":37,"tags":""},{"id":132988,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":32,"tags":""},{"id":132987,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":25,"tags":""},{"id":133028,"label":"METHOD_RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":""},{"id":133105,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":""}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133116,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133116,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133116,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133116,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133116,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133116,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133041,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133118,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133094,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":132739,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":142168,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":133024,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133118,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133093,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":132738,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":142167,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":133023,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133118,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133092,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":132737,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":142166,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":133022,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133118,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133091,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":132736,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":132795,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":142165,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":133104,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":133021,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133118,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133039,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":133096,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":132741,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":142170,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":133025,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":132952,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":132938,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":132908,"label":"BLOCK","name":"","fullName":"","signature":"","isExternal":false,"code":"_tmp_12","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":239,"columnNumber":55,"tags":""},{"id":133118,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":133311,"label":"IDENTIFIER","name":"SessionHandler","fullName":"","signature":"","isExternal":false,"code":"function SessionHandler = function SessionHandler(db) {\n    \"use strict\";\n\n    const userDAO = new UserDAO(db);\n    const allocationsDAO = new AllocationsDAO(db);\n\n    const prepareUserData = (user, next) => {\n        // Generate random allocations\n        const stocks = Math.floor((Math.random() * 40) + 1);\n        const funds = Math.floor((Math.random() * 40) + 1);\n        const bonds = 100 - (stocks + funds);\n\n        allocationsDAO.update(user._id, stocks, funds, bonds, (err) => {\n            if (err) return next(err);\n        });\n    };\n\n    this.isAdminUserMiddleware = (req, res, next) => {\n        if (req.session.userId) {\n            return userDAO.getUserById(req.session.userId, (err, user) => {\n               return user && user.isAdmin ? next() : res.redirect(\"/login\");\n            });\n        }\n        console.log(\"redirecting to login\");\n        return res.redirect(\"/login\");\n\n    };\n\n    this.isLoggedInMiddleware = (req, res, next) => {\n        if (req.session.userId) {\n            return next();\n        }\n        console.log(\"redirecting to login\");\n        return res.redirect(\"/login\");\n    };\n\n    this.displayLoginPage = (req, res, next) => {\n        return res.render(\"login\", {\n            userName: \"\",\n            password: \"\",\n            loginError: \"\",\n            environmentalScripts\n        });\n    };\n\n    this.handleLoginRequest = (req, res, next) => {\n        const {\n            userName,\n            password\n        } = req.body;\n        userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForJavaScript(userName));\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForURL(userName));\n                    // or if you know that this is a CRLF vulnerability you can target this specifically as follows:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     userName.replace(/(\\r\\n|\\r|\\n)/g, '_'));\n\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else if (err.invalidPassword) {\n                    return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidPasswordErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    });\n                } else {\n                    return next(err);\n                }\n            }\n\n            // A2-Broken Authentication and Session Management\n            // Upon login, a security best practice with regards to cookies session management\n            // would be to regenerate the session id so that if an id was already created for\n            // a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an\n            // attacker was able to get their hands on the cookie id before the user logged-in,\n            // then the old session id will render useless as the logged-in user with new privileges\n            // holds a new session id now.\n\n            // Fix the problem by regenerating a session in each login\n            // by wrapping the below code as a function callback for the method req.session.regenerate()\n            // i.e:\n            // `req.session.regenerate(() => {})`\n            req.session.userId = user._id;\n            return res.redirect(user.isAdmin ? \"/benefits\" : \"/dashboard\");\n        });\n    };\n\n    this.displayLogoutPage = (req, res) => {\n        req.session.destroy(() => res.redirect(\"/\"));\n    };\n\n    this.displaySignupPage = (req, res) => {\n        res.render(\"signup\", {\n            userName: \"\",\n            password: \"\",\n            passwordError: \"\",\n            email: \"\",\n            userNameError: \"\",\n            emailError: \"\",\n            verifyError: \"\",\n            environmentalScripts\n        });\n    };\n\n    const validateSignup = (userName, firstName, lastName, password, verify, email, errors) => {\n\n        const USER_RE = /^.{1,20}$/;\n        const FNAME_RE = /^.{1,100}$/;\n        const LNAME_RE = /^.{1,100}$/;\n        const EMAIL_RE = /^[\\S]+@[\\S]+\\.[\\S]+$/;\n        const PASS_RE = /^.{1,20}$/;\n        /*\n        //Fix for A2-2 - Broken Authentication -  requires stronger password\n        //(at least 8 characters with numbers and both lowercase and uppercase letters.)\n        const PASS_RE =/^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;\n        */\n\n        errors.userNameError = \"\";\n        errors.firstNameError = \"\";\n        errors.lastNameError = \"\";\n\n        errors.passwordError = \"\";\n        errors.verifyError = \"\";\n        errors.emailError = \"\";\n\n        if (!USER_RE.test(userName)) {\n            errors.userNameError = \"Invalid user name.\";\n            return false;\n        }\n        if (!FNAME_RE.test(firstName)) {\n            errors.firstNameError = \"Invalid first name.\";\n            return false;\n        }\n        if (!LNAME_RE.test(lastName)) {\n            errors.lastNameError = \"Invalid last name.\";\n            return false;\n        }\n        if (!PASS_RE.test(password)) {\n            errors.passwordError = \"Password must be 8 to 18 characters\" +\n                \" including numbers, lowercase and uppercase letters.\";\n            return false;\n        }\n        if (password !== verify) {\n            errors.verifyError = \"Password must match\";\n            return false;\n        }\n        if (email !== \"\") {\n            if (!EMAIL_RE.test(email)) {\n                errors.emailError = \"Invalid email address\";\n                return false;\n            }\n        }\n        return true;\n    };\n\n    this.handleSignup = (req, res, next) => {\n\n        const {\n            email,\n            userName,\n            firstName,\n            lastName,\n            password,\n            verify\n        } = req.body;\n\n        // set these up in case we have an error case\n        const errors = {\n            \"userName\": userName,\n            \"email\": email\n        };\n\n        if (validateSignup(userName, firstName, lastName, password, verify, email, errors)) {\n\n            userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    });\n\n                });\n            });\n        } else {\n            console.log(\"user did not validate\");\n            return res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            });\n        }\n    };\n\n    this.displayWelcomePage = (req, res, next) => {\n        let userId;\n\n        if (!req.session.userId) {\n            console.log(\"welcome: Unable to identify user...redirecting to login\");\n            return res.redirect(\"/login\");\n        }\n\n        userId = req.session.userId;\n\n        userDAO.getUserById(userId, (err, doc) => {\n            if (err) return next(err);\n            doc.userId = userId;\n            return res.render(\"dashboard\", {\n                ...doc,\n                environmentalScripts\n            });\n        });\n    };\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":8,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":135106,"label":"IDENTIFIER","name":"db","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":20,"tags":"framework-input, framework-output"},{"id":134834,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"server.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":24,"tags":""},{"id":134872,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":""},{"id":134870,"label":"CALL","name":"favicon","fullName":"serve-favicon","signature":"","isExternal":true,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":"pkg:npm/serve-favicon@2.5.0"},{"id":134880,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.json())","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":71,"columnNumber":4,"tags":""},{"id":134890,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":72,"columnNumber":4,"tags":""},{"id":134906,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":78,"columnNumber":4,"tags":""},{"id":134930,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.engine(\".html\", consolidate.swig)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":134939,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"view engine\", \"html\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":117,"columnNumber":4,"tags":""},{"id":134946,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"views\", `${__dirname}/app/views`)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":118,"columnNumber":4,"tags":""},{"id":134956,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(express.static(`${__dirname}/app/assets`))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":121,"columnNumber":4,"tags":""},{"id":134987,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"routes(app, db)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":132,"columnNumber":11,"tags":"framework-output"}],"purls":["pkg:npm/mongodb@2.2.36","pkg:npm/serve-favicon@2.5.0"]},{"flows":[{"id":135105,"label":"IDENTIFIER","name":"MongoClient","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":0,"tags":"pkg:npm/mongodb@2.2.36"},{"id":134834,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"server.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":24,"tags":""},{"id":134872,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":""},{"id":134870,"label":"CALL","name":"favicon","fullName":"serve-favicon","signature":"","isExternal":true,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":"pkg:npm/serve-favicon@2.5.0"},{"id":134880,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.json())","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":71,"columnNumber":4,"tags":""},{"id":134890,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":72,"columnNumber":4,"tags":""},{"id":134906,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":78,"columnNumber":4,"tags":""},{"id":134930,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.engine(\".html\", consolidate.swig)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":134939,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"view engine\", \"html\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":117,"columnNumber":4,"tags":""},{"id":134946,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"views\", `${__dirname}/app/views`)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":118,"columnNumber":4,"tags":""},{"id":134956,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(express.static(`${__dirname}/app/assets`))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":121,"columnNumber":4,"tags":""},{"id":134987,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"routes(app, db)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":132,"columnNumber":11,"tags":"framework-output"}],"purls":["pkg:npm/mongodb@2.2.36","pkg:npm/serve-favicon@2.5.0"]},{"flows":[{"id":135106,"label":"IDENTIFIER","name":"db","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":20,"tags":"framework-input, framework-output"},{"id":134834,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"server.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":24,"tags":""},{"id":134872,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":""},{"id":134870,"label":"CALL","name":"favicon","fullName":"serve-favicon","signature":"","isExternal":true,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":"pkg:npm/serve-favicon@2.5.0"},{"id":134880,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.json())","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":71,"columnNumber":4,"tags":""},{"id":134890,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":72,"columnNumber":4,"tags":""},{"id":134906,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":78,"columnNumber":4,"tags":""},{"id":134930,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.engine(\".html\", consolidate.swig)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":134939,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"view engine\", \"html\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":117,"columnNumber":4,"tags":""},{"id":134946,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"views\", `${__dirname}/app/views`)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":118,"columnNumber":4,"tags":""},{"id":134956,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(express.static(`${__dirname}/app/assets`))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":121,"columnNumber":4,"tags":""},{"id":134987,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"routes(app, db)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":132,"columnNumber":11,"tags":"framework-output"}],"purls":["pkg:npm/mongodb@2.2.36","pkg:npm/serve-favicon@2.5.0"]},{"flows":[{"id":135105,"label":"IDENTIFIER","name":"MongoClient","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":0,"tags":"pkg:npm/mongodb@2.2.36"},{"id":134834,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"server.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":24,"tags":""},{"id":134872,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":""},{"id":134870,"label":"CALL","name":"favicon","fullName":"serve-favicon","signature":"","isExternal":true,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":"pkg:npm/serve-favicon@2.5.0"},{"id":134880,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.json())","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":71,"columnNumber":4,"tags":""},{"id":134890,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":72,"columnNumber":4,"tags":""},{"id":134906,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":78,"columnNumber":4,"tags":""},{"id":134930,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.engine(\".html\", consolidate.swig)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":134939,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"view engine\", \"html\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":117,"columnNumber":4,"tags":""},{"id":134946,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"views\", `${__dirname}/app/views`)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":118,"columnNumber":4,"tags":""},{"id":134956,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(express.static(`${__dirname}/app/assets`))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":121,"columnNumber":4,"tags":""},{"id":134987,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"routes(app, db)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":132,"columnNumber":11,"tags":"framework-output"}],"purls":["pkg:npm/mongodb@2.2.36","pkg:npm/serve-favicon@2.5.0"]},{"flows":[{"id":135106,"label":"IDENTIFIER","name":"db","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":20,"tags":"framework-input, framework-output"},{"id":134834,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"server.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":24,"tags":""},{"id":134872,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":""},{"id":134870,"label":"CALL","name":"favicon","fullName":"serve-favicon","signature":"","isExternal":true,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":"pkg:npm/serve-favicon@2.5.0"},{"id":134880,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.json())","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":71,"columnNumber":4,"tags":""},{"id":134890,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":72,"columnNumber":4,"tags":""},{"id":134906,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":78,"columnNumber":4,"tags":""},{"id":134930,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.engine(\".html\", consolidate.swig)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":134939,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"view engine\", \"html\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":117,"columnNumber":4,"tags":""},{"id":134946,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"views\", `${__dirname}/app/views`)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":118,"columnNumber":4,"tags":""},{"id":134956,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(express.static(`${__dirname}/app/assets`))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":121,"columnNumber":4,"tags":""},{"id":134987,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"routes(app, db)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":132,"columnNumber":11,"tags":"framework-output"}],"purls":["pkg:npm/mongodb@2.2.36","pkg:npm/serve-favicon@2.5.0"]},{"flows":[{"id":135105,"label":"IDENTIFIER","name":"MongoClient","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":0,"tags":"pkg:npm/mongodb@2.2.36"},{"id":134834,"label":"METHOD_PARAMETER_IN","name":"this","fullName":"","signature":"","isExternal":false,"code":"this","typeFullName":"server.js::program","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":24,"tags":""},{"id":134872,"label":"IDENTIFIER","name":"this","fullName":"","signature":"","isExternal":false,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":""},{"id":134870,"label":"CALL","name":"favicon","fullName":"serve-favicon","signature":"","isExternal":true,"code":"favicon(__dirname + \"/app/assets/favicon.ico\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":68,"columnNumber":12,"tags":"pkg:npm/serve-favicon@2.5.0"},{"id":134880,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.json())","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":71,"columnNumber":4,"tags":""},{"id":134890,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":72,"columnNumber":4,"tags":""},{"id":134906,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":78,"columnNumber":4,"tags":""},{"id":134930,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.engine(\".html\", consolidate.swig)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":116,"columnNumber":4,"tags":""},{"id":134939,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"view engine\", \"html\")","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":117,"columnNumber":4,"tags":""},{"id":134946,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.set(\"views\", `${__dirname}/app/views`)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":118,"columnNumber":4,"tags":""},{"id":134956,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.use(express.static(`${__dirname}/app/assets`))","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":121,"columnNumber":4,"tags":""},{"id":134987,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"routes(app, db)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":132,"columnNumber":11,"tags":"framework-output"}],"purls":["pkg:npm/mongodb@2.2.36","pkg:npm/serve-favicon@2.5.0"]},{"flows":[{"id":135105,"label":"IDENTIFIER","name":"MongoClient","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":0,"tags":"pkg:npm/mongodb@2.2.36"}],"purls":["pkg:npm/mongodb@2.2.36"]},{"flows":[{"id":135106,"label":"IDENTIFIER","name":"db","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":20,"tags":"framework-input, framework-output"}],"purls":["pkg:npm/mongodb@2.2.36"]},{"flows":[{"id":135105,"label":"IDENTIFIER","name":"MongoClient","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":0,"tags":"pkg:npm/mongodb@2.2.36"}],"purls":["pkg:npm/mongodb@2.2.36"]},{"flows":[{"id":135106,"label":"IDENTIFIER","name":"db","fullName":"","signature":"","isExternal":false,"code":"MongoClient.connect(db, (err, db) => {\n    if (err) {\n        console.log(\"Error: DB: connect\");\n        console.log(err);\n        process.exit(1);\n    }\n    console.log(`Connected to the database`);\n\n    /*\n    // Fix for A5 - Security MisConfig\n    // TODO: Review the rest of helmet options, like \"xssFilter\"\n    // Remove default x-powered-by response header\n    app.disable(\"x-powered-by\");\n\n    // Prevent opening page in frame or iframe to protect from clickjacking\n    app.use(helmet.frameguard()); //xframe deprecated\n\n    // Prevents browser from caching and storing page\n    app.use(helmet.noCache());\n\n    // Allow loading resources only from white-listed domains\n    app.use(helmet.contentSecurityPolicy()); //csp deprecated\n\n    // Allow communication only on HTTPS\n    app.use(helmet.hsts());\n\n    // TODO: Add another vuln: https://github.com/helmetjs/helmet/issues/26\n    // Enable XSS filter in IE (On by default)\n    // app.use(helmet.iexss());\n    // Now it should be used in hit way, but the README alerts that could be\n    // dangerous, like specified in the issue.\n    // app.use(helmet.xssFilter({ setOnOldIE: true }));\n\n    // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n    app.use(nosniff());\n    */\n\n    // Adding/ remove HTTP Headers for security\n    app.use(favicon(__dirname + \"/app/assets/favicon.ico\"));\n\n    // Express middleware to populate \"req.body\" so we can access POST variables\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({\n        // Mandatory in Express v4\n        extended: false\n    }));\n\n    // Enable session management using express middleware\n    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));\n\n    /*\n    // Fix for A8 - CSRF\n    // Enable Express csrf protection\n    app.use(csrf());\n    // Make csrf token available in templates\n    app.use((req, res, next) => {\n        res.locals.csrftoken = req.csrfToken();\n        next();\n    });\n    */\n\n    // Register templating engine\n    app.engine(\".html\", consolidate.swig);\n    app.set(\"view engine\", \"html\");\n    app.set(\"views\", `${__dirname}/app/views`);\n    // Fix for A5 - Security MisConfig\n    // TODO: make sure assets are declared before app.use(session())\n    app.use(express.static(`${__dirname}/app/assets`));\n\n\n    // Initializing marked library\n    // Fix for A9 - Insecure Dependencies\n    marked.setOptions({\n        sanitize: true\n    });\n    app.locals.marked = marked;\n\n    // Application routes\n    routes(app, db);\n\n    // Template system setup\n    swig.setDefaults({\n        // Autoescape disabled\n        autoescape: false\n        /*\n        // Fix for A3 - XSS, enable auto escaping\n        autoescape: true // default value\n        */\n    });\n\n    // Insecure HTTP connection\n    http.createServer(app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n\n    /*\n    // Fix for A6-Sensitive Data Exposure\n    // Use secure HTTPS protocol\n    https.createServer(httpsOptions, app).listen(port, () => {\n        console.log(`Express http server listening on port ${port}`);\n    });\n    */\n\n})","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"server.js","parentPackageName":"<global>","parentClassName":"server.js::program","lineNumber":30,"columnNumber":20,"tags":"framework-input, framework-output"}],"purls":[]}]
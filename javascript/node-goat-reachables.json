{"reachables":[{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3338,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":18,"columnNumber":12,"tags":"framework-input"},{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4568,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":3904,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":3949,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":4061,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5914,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"},{"id":5814,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":5826,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":5823,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":24,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6255,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":6264,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":6261,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":6260,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":6330,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6236,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"},{"id":5347,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":5391,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":5397,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":5441,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"research\", {\n            environmentalScripts\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":31,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3912,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":3956,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":4062,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6422,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3409,"label":"IDENTIFIER","name":"AllocationsHandler","fullName":"","signature":"","isExternal":false,"code":"function AllocationsHandler = function AllocationsHandler(db) {\n    \"use strict\";\n\n    const allocationsDAO = new AllocationsDAO(db);\n\n    this.displayAllocations = (req, res, next) => {\n        /*\n        // Fix for A4 Insecure DOR -  take user id from session instead of from URL param\n        const { userId } = req.session;\n        */\n        const {\n            userId\n        } = req.params;\n        const {\n            threshold\n        } = req.query;\n\n        allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        });\n    };\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":6,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3338,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":18,"columnNumber":12,"tags":"framework-input"},{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"},{"id":3602,"label":"IDENTIFIER","name":"benefitsDAO","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.getAllNonAdminUsers","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":39,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5919,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userName","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":55,"columnNumber":12,"tags":""},{"id":5933,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6255,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":6264,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":6261,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":6260,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":6330,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6236,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3622,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":31,"columnNumber":12,"tags":""},{"id":3636,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6389,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"_tmp_9.email = email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":203,"columnNumber":21,"tags":""},{"id":6386,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_9.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":203,"columnNumber":12,"tags":""},{"id":6401,"label":"IDENTIFIER","name":"errors","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":83,"tags":""},{"id":6046,"label":"METHOD_PARAMETER_IN","name":"errors","fullName":"","signature":"","isExternal":false,"code":"errors","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":84,"tags":"validation"},{"id":8959,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":84,"tags":"validation"},{"id":6426,"label":"IDENTIFIER","name":"errors","fullName":"","signature":"","isExternal":false,"code":"...errors","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":250,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6234,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":6233,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":6279,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4060,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6286,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":49,"tags":""},{"id":6295,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":37,"tags":""},{"id":6292,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":32,"tags":""},{"id":6291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":25,"tags":""},{"id":6409,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3622,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":31,"columnNumber":12,"tags":""},{"id":3636,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"},{"id":3591,"label":"METHOD_PARAMETER_IN","name":"error","fullName":"","signature":"","isExternal":false,"code":"error","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":62,"tags":""},{"id":3599,"label":"IDENTIFIER","name":"error","fullName":"","signature":"","isExternal":false,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":35,"tags":""},{"id":3596,"label":"CALL","name":"next","fullName":"app/routes/benefits.js::program:next","signature":"","isExternal":true,"code":"next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":30,"tags":""},{"id":3595,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(error)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":37,"columnNumber":23,"tags":""},{"id":3638,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"","parentClassName":"","lineNumber":35,"columnNumber":61,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3618,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3617,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":4650,"label":"IDENTIFIER","name":"index","fullName":"","signature":"","isExternal":false,"code":"const index = (app, db) => {\n\n    \"use strict\";\n\n    const sessionHandler = new SessionHandler(db);\n    const profileHandler = new ProfileHandler(db);\n    const benefitsHandler = new BenefitsHandler(db);\n    const contributionsHandler = new ContributionsHandler(db);\n    const allocationsHandler = new AllocationsHandler(db);\n    const memosHandler = new MemosHandler(db);\n    const researchHandler = new ResearchHandler(db);\n\n    // Middleware to check if a user is logged in\n    const isLoggedIn = sessionHandler.isLoggedInMiddleware;\n\n    //Middleware to check if user has admin rights\n    const isAdmin = sessionHandler.isAdminUserMiddleware;\n\n    // The main page of the app\n    app.get(\"/\", sessionHandler.displayWelcomePage);\n\n    // Login form\n    app.get(\"/login\", sessionHandler.displayLoginPage);\n    app.post(\"/login\", sessionHandler.handleLoginRequest);\n\n    // Signup form\n    app.get(\"/signup\", sessionHandler.displaySignupPage);\n    app.post(\"/signup\", sessionHandler.handleSignup);\n\n    // Logout page\n    app.get(\"/logout\", sessionHandler.displayLogoutPage);\n\n    // The main page of the app\n    app.get(\"/dashboard\", isLoggedIn, sessionHandler.displayWelcomePage);\n\n    // Profile page\n    app.get(\"/profile\", isLoggedIn, profileHandler.displayProfile);\n    app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate);\n\n    // Contributions Page\n    app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions);\n    app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate);\n\n    // Benefits Page\n    app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits);\n    app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits);\n    /* Fix for A7 - checks user role to implement  Function Level Access Control\n     app.get(\"/benefits\", isLoggedIn, isAdmin, benefitsHandler.displayBenefits);\n     app.post(\"/benefits\", isLoggedIn, isAdmin, benefitsHandler.updateBenefits);\n     */\n\n    // Allocations Page\n    app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations);\n\n    // Memos Page\n    app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos);\n    app.post(\"/memos\", isLoggedIn, memosHandler.addMemos);\n\n    // Handle redirect for learning resources link\n    app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    });\n\n    // Research Page\n    app.get(\"/research\", isLoggedIn, researchHandler.displayResearch);\n\n    // Mount tutorial router\n    app.use(\"/tutorial\", tutorialRouter);\n\n    // Error handling middleware\n    app.use(ErrorHandler);\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":11,"columnNumber":6,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":3904,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":3949,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":4061,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"},{"id":3864,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":3873,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":3870,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":3869,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":4064,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":"framework-output"},{"id":3865,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":3888,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6422,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4112,"label":"IDENTIFIER","name":"ContributionsHandler","fullName":"","signature":"","isExternal":false,"code":"function ContributionsHandler = function ContributionsHandler(db) {\n    \"use strict\";\n\n    const contributionsDAO = new ContributionsDAO(db);\n\n    this.displayContributions = (req, res, next) => {\n        const {\n            userId\n        } = req.session;\n\n        contributionsDAO.getByUserId(userId, (error, contrib) => {\n            if (error) return next(error);\n\n            contrib.userId = userId; //set for nav menu items\n            return res.render(\"contributions\", {\n                ...contrib,\n                environmentalScripts\n            });\n        });\n    };\n\n    this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = par...","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":7,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":4000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":4090,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScr...","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":4087,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleContributionsUpdate","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":28,"columnNumber":4,"tags":""},{"id":8858,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":4365,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":4499,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"contributionsHandler.displayContributions","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":42,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6322,"label":"IDENTIFIER","name":"userDAO","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":16,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"},{"id":5347,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":5391,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":5397,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5919,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userName","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":55,"columnNumber":12,"tags":""},{"id":5933,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"},{"id":5814,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":5826,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":5823,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":24,"tags":""},{"id":5816,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":82,"columnNumber":27,"tags":"framework-output"},{"id":5815,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"login\", {\n                        userName: userName,\n                        password: \"\",\n                        loginError: invalidUserNameErrorMessage,\n                        //Fix for A2-2 Broken Auth - Uses identical error for both username, password error\n                        // loginError: errorMessage\n                        environmentalScripts\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":82,"columnNumber":20,"tags":""},{"id":5935,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":58,"columnNumber":50,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6422,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3904,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":3949,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":4061,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"},{"id":3864,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":3873,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":3870,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":3869,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":4064,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":4000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":4090,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScr...","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":4087,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleContributionsUpdate","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":28,"columnNumber":4,"tags":""},{"id":8858,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":4365,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":3912,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":3956,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":4062,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"},{"id":3864,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":3873,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":3870,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":3869,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":4064,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":"framework-output"},{"id":3865,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":3888,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"},{"id":5347,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":5391,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":5397,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":5439,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":31,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6322,"label":"IDENTIFIER","name":"userDAO","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":16,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3622,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":31,"columnNumber":12,"tags":""},{"id":3636,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"},{"id":3602,"label":"IDENTIFIER","name":"benefitsDAO","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.getAllNonAdminUsers","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":39,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":4853,"label":"IDENTIFIER","name":"MemosHandler","fullName":"","signature":"","isExternal":false,"code":"function MemosHandler = function MemosHandler(db) {\n    \"use strict\";\n\n    const memosDAO = new MemosDAO(db);\n\n    this.addMemos = (req, res, next) => {\n\n        memosDAO.insert(req.body.memo, (err, docs) => {\n            if (err) return next(err);\n            this.displayMemos(req, res, next);\n        });\n    };\n\n    this.displayMemos = (req, res, next) => {\n\n        const {\n            userId\n        } = req.session;\n\n        memosDAO.getAllMemos((err, docs) => {\n            if (err) return next(err);\n            return res.render(\"memos\", {\n                memosList: docs,\n                userId: userId,\n                environmentalScripts\n            });\n        });\n    };\n\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/memos.js","parentPackageName":"<global>","parentClassName":"app/routes/memos.js::program","lineNumber":6,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6384,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_9.userName = userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":202,"columnNumber":24,"tags":""},{"id":6381,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_9.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":202,"columnNumber":12,"tags":""},{"id":6401,"label":"IDENTIFIER","name":"errors","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":83,"tags":""},{"id":6046,"label":"METHOD_PARAMETER_IN","name":"errors","fullName":"","signature":"","isExternal":false,"code":"errors","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":84,"tags":"validation"},{"id":8959,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":84,"tags":"validation"},{"id":6426,"label":"IDENTIFIER","name":"errors","fullName":"","signature":"","isExternal":false,"code":"...errors","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":250,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6420,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6286,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":49,"tags":""},{"id":6295,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":37,"tags":""},{"id":6292,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":32,"tags":""},{"id":6291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":25,"tags":""},{"id":6409,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6236,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6234,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":6233,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":6279,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"},{"id":3295,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":3320,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":3317,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"},{"id":5814,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":5826,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":5823,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":24,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3920,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":3963,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":4063,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"},{"id":3864,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":3873,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":3870,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":3869,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":4064,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":"framework-output"},{"id":3865,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":3888,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":4000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":4090,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScr...","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":4087,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleContributionsUpdate","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":28,"columnNumber":4,"tags":""},{"id":8858,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":4365,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":4499,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"contributionsHandler.displayContributions","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":42,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":4568,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6422,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render(\"signup\", {\n                ...errors,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3920,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":3963,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":4063,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4060,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5919,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userName","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":55,"columnNumber":12,"tags":""},{"id":5933,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"},{"id":5814,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"console.log(\"Error: attempt to login with invalid user: \", userName)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":64,"columnNumber":79,"tags":""},{"id":5826,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"_tmp_4.userName = userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":34,"tags":""},{"id":5823,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.userName","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":83,"columnNumber":24,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6234,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":6233,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":6279,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6420,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5919,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userName","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":55,"columnNumber":12,"tags":""},{"id":5933,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4060,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6255,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":6264,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":6261,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":6260,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":6330,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6236,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3920,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":3963,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":4063,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6255,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":6264,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":6261,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":6260,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":6330,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6236,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6255,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":6264,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":6261,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":6260,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":6330,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6236,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"},{"id":3295,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":3320,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":3317,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3338,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":18,"columnNumber":12,"tags":"framework-input"},{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":3315,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":26,"columnNumber":16,"tags":""},{"id":3312,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":26,"columnNumber":16,"tags":""},{"id":3305,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":19,"tags":"framework-output"},{"id":3304,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":12,"tags":""},{"id":3365,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5496,"label":"IDENTIFIER","name":"ResearchHandler","fullName":"","signature":"","isExternal":false,"code":"function ResearchHandler = function ResearchHandler(db) {\n    \"use strict\";\n\n    const researchDAO = new ResearchDAO(db);\n\n    this.displayResearch = (req, res) => {\n\n        if (req.query.symbol) {\n            const url = req.query.url + req.query.symbol;\n            return needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            });\n        }\n\n        return res.render(\"research\", {\n            environmentalScripts\n        });\n    };\n\n}","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":7,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4060,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"},{"id":3864,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":65,"tags":""},{"id":3873,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":33,"tags":""},{"id":3870,"label":"CALL","name":"next","fullName":"app/routes/contributions.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":28,"tags":""},{"id":3869,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":67,"columnNumber":21,"tags":""},{"id":4064,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":65,"columnNumber":64,"tags":"framework-output"},{"id":3865,"label":"METHOD_PARAMETER_IN","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"contributions","typeFullName":"ANY","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":70,"tags":""},{"id":3888,"label":"IDENTIFIER","name":"contributions","fullName":"","signature":"","isExternal":false,"code":"...contributions","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":71,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3920,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":3963,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":4063,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4060,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3904,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":3949,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":4061,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""}],"purls":[]},{"flows":[{"id":5915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5914,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5919,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userName","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":55,"columnNumber":12,"tags":""},{"id":5933,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":3315,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":26,"columnNumber":16,"tags":""},{"id":3312,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":26,"columnNumber":16,"tags":""},{"id":3305,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":19,"tags":"framework-output"},{"id":3304,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":25,"columnNumber":12,"tags":""},{"id":3365,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"","parentClassName":"","lineNumber":23,"columnNumber":66,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6389,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"_tmp_9.email = email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":203,"columnNumber":21,"tags":""},{"id":6386,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_9.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":203,"columnNumber":12,"tags":""},{"id":6401,"label":"IDENTIFIER","name":"errors","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":83,"tags":""},{"id":6046,"label":"METHOD_PARAMETER_IN","name":"errors","fullName":"","signature":"","isExternal":false,"code":"errors","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":84,"tags":"validation"},{"id":8959,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":84,"tags":"validation"},{"id":6426,"label":"IDENTIFIER","name":"errors","fullName":"","signature":"","isExternal":false,"code":"...errors","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":250,"columnNumber":19,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3912,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":3956,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":4062,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3904,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":3949,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":4061,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3622,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":31,"columnNumber":12,"tags":""},{"id":3636,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6286,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":49,"tags":""},{"id":6295,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":37,"tags":""},{"id":6292,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":32,"tags":""},{"id":6291,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":210,"columnNumber":25,"tags":""},{"id":6409,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":208,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6420,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"},{"id":5347,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""},{"id":5391,"label":"IDENTIFIER","name":"body","fullName":"","signature":"","isExternal":false,"code":"res.write(body)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":25,"columnNumber":30,"tags":""},{"id":5397,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":5393,"label":"CALL","name":"end","fullName":"res.end","signature":"","isExternal":true,"code":"res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":23,"tags":"framework-output"},{"id":5392,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.end()","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":5435,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":16,"columnNumber":35,"tags":"framework-output"},{"id":5347,"label":"METHOD_PARAMETER_IN","name":"body","fullName":"","signature":"","isExternal":false,"code":"body","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":56,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3618,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3617,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"},{"id":3602,"label":"IDENTIFIER","name":"benefitsDAO","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.getAllNonAdminUsers","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":39,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4568,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5132,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"const firstNameSafeString = firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":64,"columnNumber":40,"tags":""},{"id":5149,"label":"IDENTIFIER","name":"firstNameSafeString","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString = firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5146,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.firstNameSafeString","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":67,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3338,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":18,"columnNumber":12,"tags":"framework-input"},{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":3295,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":3320,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":3317,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_6.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":60,"columnNumber":16,"tags":""},{"id":4045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":60,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5030,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":91,"columnNumber":18,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""}],"purls":[]},{"flows":[{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3618,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3617,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3622,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":31,"columnNumber":12,"tags":""},{"id":3636,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":35,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5159,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.ssn = ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""},{"id":5156,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":69,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":4000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":4090,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScr...","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":4087,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleContributionsUpdate","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":28,"columnNumber":4,"tags":""},{"id":8858,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":4365,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":4499,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"contributionsHandler.displayContributions","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":42,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5416,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"const url = req.query.url + req.query.symbol","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":15,"columnNumber":18,"tags":"framework-input"},{"id":5434,"label":"IDENTIFIER","name":"url","fullName":"","signature":"","isExternal":false,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":30,"tags":"framework-output"},{"id":5429,"label":"CALL","name":"get","fullName":"needle:get","signature":"","isExternal":true,"code":"needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":19,"tags":"framework-output"},{"id":5428,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":16,"columnNumber":12,"tags":""},{"id":5470,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.displayResearch = (req, res) => {\n\n        if (req.query.symbol) {\n            const url = req.query.url + req.query.symbol;\n            return needle.get(url, (error, newResponse, body) => {\n                if (!error && newResponse.statusCode === 200) {\n                    res.writeHead(200, {\n                        \"Content-Type\": \"text/html\"\n                    });\n                }\n                res.write(\"<h1>The following is the stock information you requested.</h1>\\n\\n\");\n                res.write(\"\\n\\n\");\n                if (body) {\n                    res.write(body);\n                }\n                return res.end();\n            });\n        }\n\n        return res.render(\"research\", {\n            environmentalScripts\n        });\n    }","typeFullName":"","parentMethodName":"ResearchHandler","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":12,"columnNumber":27,"tags":"exported"},{"id":5467,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.displayResearch","typeFullName":"","parentMethodName":"ResearchHandler","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"<global>","parentClassName":"app/routes/research.js::program","lineNumber":12,"columnNumber":4,"tags":""},{"id":8915,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ResearchHandler","parentMethodSignature":"","parentFileName":"app/routes/research.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":4395,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"new ResearchHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":21,"columnNumber":28,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6234,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":6233,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":6279,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4060,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":32,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6369,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.password","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":196,"columnNumber":12,"tags":""},{"id":6398,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":58,"tags":""},{"id":6043,"label":"METHOD_PARAMETER_IN","name":"password","fullName":"","signature":"","isExternal":false,"code":"password","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":8956,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":59,"tags":"validation"},{"id":6328,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":63,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6420,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":249,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":3882,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":70,"columnNumber":19,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4726,"label":"IDENTIFIER","name":"memosDAO","fullName":"","signature":"","isExternal":false,"code":"memosDAO.insert(req.body.memo, (err, docs) => {\n            if (err) return next(err);\n            this.displayMemos(req, res, next);\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/memos.js","parentPackageName":"<global>","parentClassName":"app/routes/memos.js::program","lineNumber":13,"columnNumber":8,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3337,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"_tmp_1 = req.params","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":16,"columnNumber":14,"tags":"framework-input"},{"id":3343,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_1.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":17,"columnNumber":12,"tags":""},{"id":3363,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":47,"tags":"framework-output"},{"id":3295,"label":"METHOD_PARAMETER_IN","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"allocations","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":72,"tags":""},{"id":3320,"label":"IDENTIFIER","name":"allocations","fullName":"","signature":"","isExternal":false,"code":"_tmp_3.allocations = allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""},{"id":3317,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.allocations","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":27,"columnNumber":16,"tags":""}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6234,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":6233,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":6279,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5914,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5188,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":80,"columnNumber":12,"tags":""},{"id":5187,"label":"IDENTIFIER","name":"_tmp_6","fullName":"","signature":"","isExternal":false,"code":"_tmp_6 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":78,"columnNumber":14,"tags":""},{"id":5193,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_6.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":79,"columnNumber":12,"tags":""},{"id":5203,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":21,"tags":""},{"id":5048,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"user.userId = userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":30,"tags":""},{"id":5045,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user.userId","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":98,"columnNumber":16,"tags":""},{"id":5058,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":101,"columnNumber":23,"tags":""},{"id":5050,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"},{"id":5049,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":16,"tags":""},{"id":5211,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":91,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5915,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5914,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":57,"columnNumber":12,"tags":"framework-input"},{"id":5913,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":54,"columnNumber":14,"tags":"framework-input"},{"id":5924,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.password","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":56,"columnNumber":12,"tags":""},{"id":5934,"label":"IDENTIFIER","name":"password","fullName":"","signature":"","isExternal":false,"code":"userDAO.validateLogin(userName, password, (err, user) => {\n            const errorMessage = \"Invalid username and/or password\";\n            const invalidUserNameErrorMessage = \"Invalid username\";\n            const invalidPasswordErrorMessage = \"Invalid password\";\n            if (err) {\n                if (err.noSuchUser) {\n                    console.log(\"Error: attempt to login with invalid user: \", userName);\n\n                    // Fix for A1 - 3 Log Injection - encode/sanitize input for CRLF Injection\n                    // that could result in log forging:\n                    // - Step 1: Require a module that supports encoding\n                    // const ESAPI = require('node-esapi');\n                    // - Step 2: Encode the user input that will be logged in the correct context\n                    // following are a few examples:\n                    // console.log('Error: attempt to login with invalid user: %s',\n                    //     ESAPI.encoder().encodeForHTML(user...","typeFullName":"","parentMethodName":"anonymous4","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":58,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3689,"label":"IDENTIFIER","name":"BenefitsHandler","fullName":"","signature":"","isExternal":false,"code":"function BenefitsHandler = function BenefitsHandler(db) {\n    \"use strict\";\n\n    const benefitsDAO = new BenefitsDAO(db);\n\n    this.displayBenefits = (req, res, next) => {\n\n        benefitsDAO.getAllNonAdminUsers((error, users) => {\n\n            if (error) return next(error);\n\n            return res.render(\"benefits\", {\n                users,\n                user: {\n                    isAdmin: true\n                },\n                environmentalScripts\n            });\n        });\n    };\n\n    this.updateBenefits = (req, res, next) => {\n        const {\n            userId,\n            benefitStartDate\n        } = req.body;\n\n        benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n               ...","typeFullName":"","parentMethodName":":program","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":8,"columnNumber":0,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5081,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.firstName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3920,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":3963,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":4063,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":4568,"label":"IDENTIFIER","name":"isLoggedIn","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":22,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3904,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"const preTax = eval(req.body.preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":32,"columnNumber":14,"tags":"framework-input"},{"id":3949,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(preTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":35,"tags":""},{"id":4061,"label":"IDENTIFIER","name":"preTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":40,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5091,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.ssn","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":45,"columnNumber":12,"tags":""},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6255,"label":"METHOD_PARAMETER_IN","name":"err","fullName":"","signature":"","isExternal":false,"code":"err","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":81,"tags":""},{"id":6264,"label":"IDENTIFIER","name":"err","fullName":"","signature":"","isExternal":false,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":41,"tags":""},{"id":6261,"label":"CALL","name":"next","fullName":"app/routes/session.js::program:next","signature":"","isExternal":true,"code":"next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":36,"tags":""},{"id":6260,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return next(err)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":222,"columnNumber":29,"tags":""},{"id":6330,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":220,"columnNumber":80,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5179,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankRouting = bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5176,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":73,"columnNumber":16,"tags":""},{"id":5052,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.render","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":100,"columnNumber":23,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5101,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":47,"columnNumber":12,"tags":""},{"id":5169,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.address = address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5166,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.address","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":71,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5077,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5076,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":50,"columnNumber":12,"tags":"framework-input"},{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5111,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankRouting","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":49,"columnNumber":12,"tags":""},{"id":5125,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"regexPattern.test(bankRouting)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":61,"columnNumber":61,"tags":""},{"id":5210,"label":"IDENTIFIER","name":"bankRouting","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":90,"columnNumber":12,"tags":"framework-output"},{"id":5202,"label":"CALL","name":"parseInt","fullName":"parseInt","signature":"","isExternal":true,"code":"parseInt(userId)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":83,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5204,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":84,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.email","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":192,"columnNumber":12,"tags":""},{"id":6400,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":76,"tags":""},{"id":6045,"label":"METHOD_PARAMETER_IN","name":"email","fullName":"","signature":"","isExternal":false,"code":"email","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":8958,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":77,"tags":"validation"},{"id":6329,"label":"IDENTIFIER","name":"email","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":73,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6268,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"prepareUserData(user, next)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":225,"columnNumber":36,"tags":""},{"id":5574,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":14,"columnNumber":29,"tags":""},{"id":5620,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"user._id","typeFullName":"","parentMethodName":"prepareUserData","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":20,"columnNumber":30,"tags":""}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6364,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.lastName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":195,"columnNumber":12,"tags":""},{"id":6397,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":48,"tags":""},{"id":6042,"label":"METHOD_PARAMETER_IN","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"lastName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":8955,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":49,"tags":"validation"},{"id":6327,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":53,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5174,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.bankAcc = bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5171,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":72,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5086,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":5154,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.lastName = lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5151,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.lastName","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":68,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3618,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3617,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":33,"columnNumber":12,"tags":"framework-input"},{"id":3616,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":30,"columnNumber":14,"tags":"framework-input"},{"id":3627,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.benefitStartDate","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":32,"columnNumber":12,"tags":""},{"id":3637,"label":"IDENTIFIER","name":"benefitStartDate","fullName":"","signature":"","isExternal":false,"code":"benefitsDAO.updateBenefits(userId, benefitStartDate, (error) => {\n\n            if (error) return next(error);\n\n            benefitsDAO.getAllNonAdminUsers((error, users) => {\n                if (error) return next(error);\n\n                const data = {\n                    users,\n                    user: {\n                        isAdmin: true\n                    },\n                    updateSuccess: true,\n                    environmentalScripts\n                };\n\n                return res.render(\"benefits\", data);\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/benefits.js","parentPackageName":"<global>","parentClassName":"app/routes/benefits.js::program","lineNumber":35,"columnNumber":43,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3350,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3349,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":21,"columnNumber":12,"tags":"framework-input"},{"id":3348,"label":"IDENTIFIER","name":"_tmp_2","fullName":"","signature":"","isExternal":false,"code":"_tmp_2 = req.query","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":19,"columnNumber":14,"tags":"framework-input"},{"id":3354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_2.threshold","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":20,"columnNumber":12,"tags":""},{"id":3364,"label":"IDENTIFIER","name":"threshold","fullName":"","signature":"","isExternal":false,"code":"allocationsDAO.getByUserIdAndThreshold(userId, threshold, (err, allocations) => {\n            if (err) return next(err);\n            return res.render(\"allocations\", {\n                userId,\n                allocations,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/allocations.js","parentPackageName":"<global>","parentClassName":"app/routes/allocations.js::program","lineNumber":23,"columnNumber":55,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4310,"label":"CALL","name":"redirect","fullName":"res.redirect","signature":"","isExternal":true,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"},{"id":4309,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":8,"tags":""},{"id":4569,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"","parentClassName":"","lineNumber":70,"columnNumber":34,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5164,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.dob = dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5161,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":70,"columnNumber":16,"tags":""},{"id":5134,"label":"CALL","name":"render","fullName":"","signature":"","isExternal":false,"code":"res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":19,"tags":"framework-output"},{"id":5133,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"profile\", {\n                updateError: \"Bank Routing number does not comply with requirements for format specified\",\n                firstNameSafeString,\n                lastName,\n                ssn,\n                dob,\n                address,\n                bankAcc,\n                bankRouting,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":65,"columnNumber":12,"tags":""},{"id":5237,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleProfileUpdate = (req, res, next) => {\n\n        const {\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting\n        } = req.body;\n\n        // Fix for Section: ReDoS attack\n        // The following regexPattern that is used to validate the bankRouting number is insecure and vulnerable to\n        // catastrophic backtracking which means that specific type of input may cause it to consume all CPU resources\n        // with an exponential time until it completes\n        // --\n        // The Fix: Instead of using greedy quantifiers the same regex will work if we omit the second quantifier +\n        // const regexPattern = /([0-9]+)\\#/;\n        const regexPattern = /([0-9]+)+\\#/;\n        // Allow only numbers with a suffix of the letter #, for example: 'XXXXXX#'\n        const testComplyWithRequirements = regexPattern.test(bankRouting);\n        // if the regex test fails we do not allow sa...","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":40,"columnNumber":31,"tags":"exported"},{"id":5234,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleProfileUpdate","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":40,"columnNumber":4,"tags":""},{"id":8905,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ProfileHandler","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"","parentClassName":"","lineNumber":8,"columnNumber":0,"tags":"exported"},{"id":4345,"label":"IDENTIFIER","name":"_tmp_1","fullName":"","signature":"","isExternal":false,"code":"new ProfileHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":16,"columnNumber":27,"tags":"framework-output"},{"id":4479,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"profileHandler.displayProfile","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":47,"columnNumber":36,"tags":""},{"id":4486,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/profile\", isLoggedIn, profileHandler.handleProfileUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":48,"columnNumber":4,"tags":""},{"id":4496,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/contributions\", isLoggedIn, contributionsHandler.displayContributions)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":4,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4312,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5096,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.dob","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":46,"columnNumber":12,"tags":""},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3920,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"const roth = eval(req.body.roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":14,"tags":"framework-input"},{"id":3963,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"isNaN(roth)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":67,"tags":""},{"id":4063,"label":"IDENTIFIER","name":"roth","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":58,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":5075,"label":"IDENTIFIER","name":"_tmp_4","fullName":"","signature":"","isExternal":false,"code":"_tmp_4 = req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":42,"columnNumber":14,"tags":"framework-input"},{"id":5106,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_4.bankAcc","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":48,"columnNumber":12,"tags":""},{"id":5209,"label":"IDENTIFIER","name":"bankAcc","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":89,"columnNumber":12,"tags":"framework-output"},{"id":5201,"label":"IDENTIFIER","name":"profile","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":82,"columnNumber":8,"tags":"framework-output"},{"id":5207,"label":"IDENTIFIER","name":"dob","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":87,"columnNumber":12,"tags":"framework-output"},{"id":5208,"label":"IDENTIFIER","name":"address","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":88,"columnNumber":12,"tags":"framework-output"},{"id":5205,"label":"IDENTIFIER","name":"lastName","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":85,"columnNumber":12,"tags":"framework-output"},{"id":5206,"label":"IDENTIFIER","name":"ssn","fullName":"","signature":"","isExternal":false,"code":"profile.updateUser(\n            parseInt(userId),\n            firstName,\n            lastName,\n            ssn,\n            dob,\n            address,\n            bankAcc,\n            bankRouting,\n            (err, user) => {\n\n                if (err) return next(err);\n\n                // WARN: Applying any sting specific methods here w/o checking type of inputs could lead to DoS by HPP\n                //firstName = firstName.trim();\n                user.updateSuccess = true;\n                user.userId = userId;\n\n                return res.render(\"profile\", {\n                    ...user,\n                    environmentalScripts\n                });\n            }\n        )","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/profile.js","parentPackageName":"<global>","parentClassName":"app/routes/profile.js::program","lineNumber":86,"columnNumber":12,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3912,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":3956,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":4062,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6345,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6344,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":198,"columnNumber":12,"tags":"framework-input"},{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6359,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.firstName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":194,"columnNumber":12,"tags":""},{"id":6396,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":37,"tags":""},{"id":6041,"label":"METHOD_PARAMETER_IN","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"firstName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":8954,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":38,"tags":"validation"},{"id":6326,"label":"IDENTIFIER","name":"firstName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":42,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3912,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":3956,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":4062,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":3924,"label":"IDENTIFIER","name":"req","fullName":"","signature":"","isExternal":false,"code":"req.body","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":34,"columnNumber":26,"tags":"framework-input"},{"id":3929,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":44,"columnNumber":12,"tags":""},{"id":3928,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"_tmp_3 = req.session","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":42,"columnNumber":14,"tags":""},{"id":3934,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_3.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":43,"columnNumber":12,"tags":""},{"id":4016,"label":"IDENTIFIER","name":"userId","fullName":"","signature":"","isExternal":false,"code":"_tmp_5.userId = userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4013,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_5.userId","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":52,"columnNumber":16,"tags":""},{"id":4001,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":19,"tags":"framework-output"},{"id":4000,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScripts\n            })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":50,"columnNumber":12,"tags":""},{"id":4090,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"this.handleContributionsUpdate = (req, res, next) => {\n\n        /*jslint evil: true */\n        // Insecure use of eval() to parse inputs\n        const preTax = eval(req.body.preTax);\n        const afterTax = eval(req.body.afterTax);\n        const roth = eval(req.body.roth);\n\n        /*\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        const preTax = parseInt(req.body.preTax);\n        const afterTax = parseInt(req.body.afterTax);\n        const roth = parseInt(req.body.roth);\n        */\n        const {\n            userId\n        } = req.session;\n\n        //validate contributions\n        const validations = [isNaN(preTax), isNaN(afterTax), isNaN(roth), preTax < 0, afterTax < 0, roth < 0];\n        const isInvalid = validations.some(validation => validation);\n        if (isInvalid) {\n            return res.render(\"contributions\", {\n                updateError: \"Invalid contribution percentages\",\n                userId,\n                environmentalScr...","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":28,"columnNumber":37,"tags":"exported"},{"id":4087,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"this.handleContributionsUpdate","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":28,"columnNumber":4,"tags":""},{"id":8858,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"ContributionsHandler","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"","parentClassName":"","lineNumber":7,"columnNumber":0,"tags":"exported"},{"id":4365,"label":"IDENTIFIER","name":"_tmp_3","fullName":"","signature":"","isExternal":false,"code":"new ContributionsHandler(db)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":18,"columnNumber":33,"tags":"framework-output"},{"id":4499,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"contributionsHandler.displayContributions","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":51,"columnNumber":42,"tags":""},{"id":4506,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/contributions\", isLoggedIn, contributionsHandler.handleContributionsUpdate)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":52,"columnNumber":4,"tags":""},{"id":4516,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/benefits\", isLoggedIn, benefitsHandler.displayBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":55,"columnNumber":4,"tags":""},{"id":4526,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/benefits\", isLoggedIn, benefitsHandler.updateBenefits)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":56,"columnNumber":4,"tags":""},{"id":4536,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/allocations/:userId\", isLoggedIn, allocationsHandler.displayAllocations)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":63,"columnNumber":4,"tags":""},{"id":4546,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/memos\", isLoggedIn, memosHandler.displayMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":66,"columnNumber":4,"tags":""},{"id":4556,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.post(\"/memos\", isLoggedIn, memosHandler.addMemos)","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":67,"columnNumber":4,"tags":""},{"id":4566,"label":"IDENTIFIER","name":"app","fullName":"","signature":"","isExternal":false,"code":"app.get(\"/learn\", isLoggedIn, (req, res) => {\n        // Insecure way to handle redirects by taking redirect url from query string\n        return res.redirect(req.query.url);\n    })","typeFullName":"","parentMethodName":"index","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":4,"tags":"framework-input, framework-output"},{"id":4307,"label":"METHOD_PARAMETER_IN","name":"res","fullName":"","signature":"","isExternal":false,"code":"res","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":70,"columnNumber":40,"tags":""},{"id":4314,"label":"IDENTIFIER","name":"res","fullName":"","signature":"","isExternal":false,"code":"res.redirect(req.query.url)","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/index.js","parentPackageName":"<global>","parentClassName":"app/routes/index.js::program","lineNumber":72,"columnNumber":15,"tags":"framework-input, framework-output"}],"purls":[]},{"flows":[{"id":3912,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"const afterTax = eval(req.body.afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":33,"columnNumber":14,"tags":"framework-input"},{"id":3956,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"isNaN(afterTax)","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":47,"columnNumber":50,"tags":""},{"id":4062,"label":"IDENTIFIER","name":"afterTax","fullName":"","signature":"","isExternal":false,"code":"contributionsDAO.update(userId, preTax, afterTax, roth, (err, contributions) => {\n\n            if (err) return next(err);\n\n            contributions.updateSuccess = true;\n            return res.render(\"contributions\", {\n                ...contributions,\n                environmentalScripts\n            });\n        })","typeFullName":"","parentMethodName":"anonymous1","parentMethodSignature":"","parentFileName":"app/routes/contributions.js","parentPackageName":"<global>","parentClassName":"app/routes/contributions.js::program","lineNumber":65,"columnNumber":48,"tags":"framework-output"}],"purls":[]},{"flows":[{"id":6343,"label":"IDENTIFIER","name":"_tmp_8","fullName":"","signature":"","isExternal":false,"code":"_tmp_8 = req.body","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":191,"columnNumber":14,"tags":"framework-input"},{"id":6354,"label":"CALL","name":"<operator>.fieldAccess","fullName":"<operator>.fieldAccess","signature":"","isExternal":false,"code":"_tmp_8.userName","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":193,"columnNumber":12,"tags":""},{"id":6395,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"validateSignup(userName, firstName, lastName, password, verify, email, errors)","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":206,"columnNumber":27,"tags":""},{"id":6040,"label":"METHOD_PARAMETER_IN","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userName","typeFullName":"ANY","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6099,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"USER_RE.test(userName)","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":159,"columnNumber":26,"tags":""},{"id":8953,"label":"METHOD_PARAMETER_OUT","name":"","fullName":"","signature":"","isExternal":false,"code":"RET","typeFullName":"","parentMethodName":"validateSignup","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":138,"columnNumber":28,"tags":"validation"},{"id":6408,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.getUserByUserName(userName, (err, user) => {\n\n                if (err) return next(err);\n\n                if (user) {\n                    errors.userNameError = \"User name already in use. Please choose another\";\n                    return res.render(\"signup\", {\n                        ...errors,\n                        environmentalScripts\n                    });\n                }\n\n                userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n       ...","typeFullName":"","parentMethodName":"anonymous8","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":208,"columnNumber":38,"tags":"framework-output"},{"id":6325,"label":"IDENTIFIER","name":"userName","fullName":"","signature":"","isExternal":false,"code":"userDAO.addUser(userName, firstName, lastName, password, email, (err, user) => {\n\n                    if (err) return next(err);\n\n                    //prepare data for the user\n                    prepareUserData(user, next);\n                    /*\n                    sessionDAO.startSession(user._id, (err, sessionId) => {\n                        if (err) return next(err);\n                        res.cookie(\"session\", sessionId);\n                        req.session.userId = user._id;\n                        return res.render(\"dashboard\", { ...user, environmentalScripts });\n                    });\n                    */\n                    req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environment...","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":32,"tags":"framework-output"},{"id":6256,"label":"METHOD_PARAMETER_IN","name":"user","fullName":"","signature":"","isExternal":false,"code":"user","typeFullName":"ANY","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":220,"columnNumber":86,"tags":""},{"id":6242,"label":"IDENTIFIER","name":"user","fullName":"","signature":"","isExternal":false,"code":"...user","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":240,"columnNumber":31,"tags":""},{"id":6234,"label":"CALL","name":"render","fullName":"res.render","signature":"","isExternal":true,"code":"res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":31,"tags":"framework-output"},{"id":6233,"label":"RETURN","name":"","fullName":"","signature":"","isExternal":false,"code":"return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"<global>","parentClassName":"app/routes/session.js::program","lineNumber":239,"columnNumber":24,"tags":""},{"id":6279,"label":"METHOD_REF","name":"","fullName":"","signature":"","isExternal":false,"code":"req.session.regenerate(() => {\n                        req.session.userId = user._id;\n                        // Set userId property. Required for left nav menu links\n                        user.userId = user._id;\n\n                        return res.render(\"dashboard\", {\n                            ...user,\n                            environmentalScripts\n                        });\n                    })","typeFullName":"","parentMethodName":"anonymous","parentMethodSignature":"","parentFileName":"app/routes/session.js","parentPackageName":"","parentClassName":"","lineNumber":234,"columnNumber":43,"tags":"framework-output"}],"purls":[]}]}